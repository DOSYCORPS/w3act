@(form: Form[models.Collection], user: User, collectionData :com.fasterxml.jackson.databind.JsonNode)

@getJson(data: com.fasterxml.jackson.databind.JsonNode) = @{
	Html(data.toString)
}

@scripts = {
	<script src="@routes.Assets.at("bootstrap/typeahead/js/typeahead.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.at("javascripts/search.js")" type="text/javascript"></script>
	<script>
		$(document).ready(function() {
			context = '@play.api.Play.current.configuration.getString("application.context")'
			applySearch(context, 'collections'); 

			showTree(@getJson(collectionData), "#collectionTree", "collectionSelect");
            
		});
	</script>
}

@if(user.hasRole("sys_admin") || user.hasRole("archivist")) {

	@main("", user, scripts) {
	    
	   	<div class="page-header">
		    <h1><a href="@routes.CollectionController.index()">Taxonomies > Collections > </a>Collection @form("title").value</h1>
	    </div>
	    
		<ul class="nav nav-tabs">
			<li><a href="@routes.CollectionController.view(form.get.id)">View</a></li>
			@if(user.hasRole("sys_admin") || user.hasRole("archivist")) {
			   <li class="active"><a href="@routes.CollectionController.edit(form.get.id)">Edit</a></li>
			}
			<li><a href="@routes.CollectionController.sites(form.get.url)">Targets</a></li>
		</ul>
		
	    @warningmessage(flash)
		@helper.form(action=routes.CollectionController.save) {
	   	    <input type="hidden" name="id" value="@form.get.id">

			<div class="row padding-10">
	     		<div class="col-md-12 col-xs-12 col-sm-12">
					<div class="form-group">
						<label for="inputName" class="col-sm-6 control-label">Title <font color="red">*</font></label>
					    <div class="col-sm-6">
							<input class="form-control" name="name" id="title" value="@form.get.name" type="text">
						</div>
					</div>
				</div>
	     	</div>
	     	
	   		<div class="row padding-10">
	     		<div class="col-md-12 col-xs-12 col-sm-12">
					<div class="form-group">
		              	<label for="suggestions-collections" class="col-sm-6 control-label">Parent</label>
					    <div class="col-sm-6">
							@if(user.hasRole("sys_admin") || user.hasRole("archivist") || user.hasRole("expert_user")) {
								<div id="collectionTree"></div>
						  		<input type="hidden" id="collectionSelect" name="collectionSelect" value="@form.get.parent">
							} else {
								@if(form.get.url != null) {
									@form.get.parent
								} else {
								    None
								}
	     	              }	   
						</div>
					</div>
				</div>
	     	</div>	   

			@if(user.hasRole("sys_admin") || user.hasRole("archivist")) {
		   		<div class="row padding-10">
		     		<div class="col-md-12 col-xs-12 col-sm-12">
						<div class="form-group">
							<label class="col-sm-6 control-label">Publish</label>
						    <div class="col-sm-6">
				                @if(form.get.publish != null && form.get.publish) {             
					                <input type="checkbox" name="publish" value="true" checked/>
				                } else {
					                <input type="checkbox" name="publish" value="true"/>
				                }
							</div>
						</div>
					</div>
		     	</div>		     				     	
			}     	
		
			<div class="row padding-10">
	     		<div class="col-md-12 col-xs-12 col-sm-12">
					<div class="form-group">
						<label for="inputDescription" class="col-sm-6 control-label">Description</label>
					    <div class="col-sm-6">
			          		<textarea class="form-control" name="description" id="inputDescription" cols="100" rows="1">@form.get.description</textarea>
						</div>
					</div>
				</div>
			</div>
		
			<div class="row padding-10">
	     		<div class="col-md-12 col-xs-12 col-sm-12">
	     			<div class="form-group">
						<label for="inputRevision" class="col-sm-6 control-label">Revision log message</label>
					    <div class="col-sm-6">
							<textarea class="form-control text-full form-textarea" name="revision" id="inputRevision" cols="100" rows="1">@form.get.revision</textarea>
						</div>
					</div>
				</div>
			</div>
    	
	    	@if(user.hasRole("sys_admin") || user.hasRole("archivist")) {
				<div class="row padding-10 pull-right">
		     		<div class="col-md-12 col-xs-12 col-sm-12">
						<div class="btn-group">
							<button type="submit" class="btn btn-primary" name="save">Save</button>
							<button type="submit" class="btn btn-primary" name="delete" onclick="return confirm('Are you sure?');">Delete</button>
				       </div>
					</div>
				</div>
			}
		}
	}
} else {
	@infomessage.render("Access Denied for URL @routes.CollectionController.index()/edit")
}


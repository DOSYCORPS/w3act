@(document: Document)

<?xml version="1.0" encoding="utf-8"?>
<mets:mets TYPE="@if(document.isBookOrBookChapter) {eBooks} else {eJournal}"
    xmlns:mets="http://www.loc.gov/METS/"
    xmlns:premis="info:lc/xmlns/premis-v2"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:mods="http://www.loc.gov/mods/v3"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.loc.gov/METS/ http://www.loc.gov/standards/mets/mets.xsd
        info:lc/xmlns/premis-v2 http://www.loc.gov/standards/premis/premis.xsd
        http://www.loc.gov/mods/v3 http://www.loc.gov/mods/v3/mods-3-4.xsd">
  <mets:metsHdr CREATEDATE="@document.currentStatusSetUTCString">
    <mets:agent ROLE="CREATOR" TYPE="OTHER" OTHERTYPE="SOFTWARE">
      <mets:name>ACT;1.0</mets:name>
    </mets:agent>
    <mets:metsDocumentID>@document.ark</mets:metsDocumentID>
  </mets:metsHdr>
  <mets:dmdSec ID="dmd0001">
  @if(document.isWholeBook) {
    <mets:mdWrap MDTYPE="MARC">
      <mets:xmlData>
        <collection xmlns="http://www.loc.gov/MARC21/slim">
          <record>
            <leader>     nam a22     5i 4500</leader>
         	<datafield tag="ITM" ind1="" ind2="">
              <subfield code="a">dvdc_300018257173.0x000001</subfield>
			</datafield>
            <datafield tag="245" ind1="0" ind2=" ">
              <subfield code="a">@document.title</subfield>
            </datafield>
          @if(!document.book.isbn.isEmpty) {
            <datafield tag="020" ind1=" " ind2=" ">
              <subfield code="a">@document.book.isbn</subfield>
            </datafield>
          }
          @if(!document.doi.isEmpty) {
            <datafield tag="024" ind1="7" ind2=" ">
              <subfield code="a">@document.doi</subfield>
              <subfield code="2">doi</subfield>
            </datafield>
          }
          @if(!document.book.edition.isEmpty) {
            <datafield tag="250" ind1=" " ind2=" ">
              <subfield code="a">@document.book.edition</subfield>
            </datafield>
          }
            <datafield tag="264" ind1=" " ind2="1">
            @if(!document.book.publisher.isEmpty) {
              <subfield code="b">@document.book.publisher</subfield>
            }
              <subfield code="c">@document.publicationYear</subfield>
            </datafield>
          @if(!document.book.series.isEmpty) {
            <datafield tag="490" ind1="0" ind2=" ">
              <subfield code="a">@document.book.series</subfield>
            </datafield>
          }
          @if(!document.author1Ln.isEmpty) {
            <datafield tag="100" ind1="1" ind2=" ">
              <subfield code="a">@document.author1Ln, @document.author1Fn</subfield>
            </datafield>
          }
          @if(!document.author2Ln.isEmpty) {
            <datafield tag="700" ind1="1" ind2=" ">
              <subfield code="a">@document.author2Ln, @document.author2Fn</subfield>
            </datafield>
          }
          @if(!document.author3Ln.isEmpty) {
            <datafield tag="700" ind1="1" ind2=" ">
              <subfield code="a">@document.author3Ln, @document.author3Fn</subfield>
            </datafield>
          }
          @if(!document.book.corporateAuthor.isEmpty) {
            <datafield tag="710" ind1="2" ind2=" ">
              <subfield code="a">@document.book.corporateAuthor</subfield>
            </datafield>
          }
          @for(blCollectionSubset <- document.book.blCollectionSubsets) {
            <datafield tag="690" ind1="7" ind2=" ">
              <subfield code="a">@blCollectionSubset.title</subfield>
              <subfield code="2">blcoll</subfield>
            </datafield>
          }
          @for(fastSubject <- document.fastSubjects) {
            <datafield tag="650" ind1=" " ind2="7">
              <subfield code="a">@fastSubject.name</subfield>
              <subfield code="2">fast</subfield>
              <subfield code="0">(OCoLC)@fastSubject.fastId</subfield>
            </datafield>
          }
          @if(document.priorityCataloguing) {
            <datafield tag="985" ind1=" " ind2=" ">
              <subfield code="a">Priority cataloguing</subfield>
            </datafield>
          }
          </record>
        </collection>
      </mets:xmlData>
    </mets:mdWrap>
  }
  @if(document.isJournalArticleOrIssue) {
    <mets:mdWrap MDTYPE="MODS">
      <mets:xmlData>
        <mods:mods>
          <mods:titleInfo>
            <mods:title>@document.title</mods:title>
          </mods:titleInfo>
        @if(!document.doi.isEmpty) {
          <mods:identifier type="DOI">@document.doi</mods:identifier>
        }
        @if(document.publicationDate != null) {
          <mods:originInfo>
            <mods:dateIssued encoding="w3cdtf">@document.publicationDate</mods:dateIssued>
            @*<mods:issuance>@document.journal.journalTitle.frequency</mods:issuance>*@
          </mods:originInfo>
        }
          <mods:part>
          @if(!document.journal.volume.isEmpty) {
            <mods:detail type="volume">
              <mods:number>@document.journal.volume</mods:number>
              <mods:caption>vol.</mods:caption>
            </mods:detail>
          }
          @if(!document.journal.issue.isEmpty) {
            <mods:detail type="issue">
              <mods:number>@document.journal.issue</mods:number>
              <mods:caption>no.</mods:caption>
            </mods:detail>
          }
          </mods:part>
        @if(!document.author1Ln.isEmpty) {
          <mods:name>
            <mods:role>
              <mods:roleTerm type="code" authority="marcrelator">aut</mods:roleTerm>
            </mods:role>
            <mods:namePart type="given">@document.author1Fn</mods:namePart>
            <mods:namePart type="family">@document.author1Ln</mods:namePart>
          </mods:name>
        }
        @if(!document.author2Ln.isEmpty) {
          <mods:name>
            <mods:role>
              <mods:roleTerm type="code" authority="marcrelator">aut</mods:roleTerm>
            </mods:role>
            <mods:namePart type="given">@document.author2Fn</mods:namePart>
            <mods:namePart type="family">@document.author2Ln</mods:namePart>
          </mods:name>
        }
        @if(!document.author3Ln.isEmpty) {
          <mods:name>
            <mods:role>
              <mods:roleTerm type="code" authority="marcrelator">aut</mods:roleTerm>
            </mods:role>
            <mods:namePart type="given">@document.author3Fn</mods:namePart>
            <mods:namePart type="family">@document.author3Ln</mods:namePart>
          </mods:name>
        }
        @for(portal <- document.portals) {
          <mods:note type="admin" displayLabel="Service">@portal.title</mods:note>
        }
        @if(document.priorityCataloguing) {
          <mods:note type="admin" displayLabel="Priority Cataloguing">Aleph</mods:note>
        }
          <mods:relatedItem type="host" displayLabel="Journal">
            <mods:titleInfo>
              <mods:title>@document.journal.journalTitle.title</mods:title>
            </mods:titleInfo>
            <mods:originInfo>
              <mods:publisher>@document.journal.journalTitle.publisherName</mods:publisher>
            </mods:originInfo>
          @if(!document.journal.journalTitle.issn.isEmpty) {
            <mods:identifier type="pub-id e-issn">
              @document.journal.journalTitle.issn
            </mods:identifier>
          }
          </mods:relatedItem>
        @if(!document.journal.journalTitle.blCollectionSubsets.isEmpty) {
          <mods:location>
            <mods:physicalLocation authority="marcorg">Uk</mods:physicalLocation>
            <mods:holdingSimple>
              <mods:copyInformation>
              @for(blCollectionSubset <- document.journal.journalTitle.blCollectionSubsets) {
                <mods:subLocation>@blCollectionSubset.title</mods:subLocation>
              }
              </mods:copyInformation>
            </mods:holdingSimple>
          </mods:location>
        }
          @*<mods:languageOfCataloging>
            <mods:languageTerm type="code" authority="iso639-2b">
              @document.journal.journalTitle.language
            </mods:languageTerm>
          </mods:languageOfCataloging>*@
             @for(fastSubject <- document.fastSubjects) {
        <mods:subject authority="fast" valueURI="(OCoLC)@fastSubject.fastId"></mods:subject>
      }
        </mods:mods>
      </mets:xmlData>
    </mets:mdWrap>
  }
  </mets:dmdSec>
  <mets:dmdSec ID="dmd0002">
    <mets:mdRef LOCTYPE="ARK" MDTYPE="MARC" OTHERMDTYPE="ALEPH" xlink:href="ark:/81055/dvdc_300018257173.0x000001" />
  </mets:dmdSec>
  <mets:amdSec ID="amd0001">
    <mets:digiprovMD ID="amd0001-object">
      <mets:mdWrap MDTYPE="PREMIS:OBJECT">
        <mets:xmlData>
          <premis:object xsi:type="premis:file">
            <premis:objectIdentifier>
              <premis:objectIdentifierType>ARK</premis:objectIdentifierType>
              <premis:objectIdentifierValue>@document.ark</premis:objectIdentifierValue>
            </premis:objectIdentifier>
            <premis:objectCharacteristics>
              <premis:compositionLevel>0</premis:compositionLevel>
              <premis:fixity>
                <premis:messageDigestAlgorithm>SHA-256</premis:messageDigestAlgorithm>
                <premis:messageDigest>@document.sha256Hash</premis:messageDigest>
              </premis:fixity>
              <premis:size>@document.size</premis:size>
              <premis:format>
                <premis:formatDesignation>
                  <premis:formatName>application/pdf</premis:formatName>
                </premis:formatDesignation>
              </premis:format>
            </premis:objectCharacteristics>
            <premis:originalName>@document.documentUrl</premis:originalName>
          </premis:object>
        </mets:xmlData>
      </mets:mdWrap>
    </mets:digiprovMD>
  </mets:amdSec> 
  <mets:fileSec>
    <mets:fileGrp USE="Original">
      <mets:file ADMID="amd0001-object" ID="file0001">
        <mets:FLocat LOCTYPE="OTHER" OTHERLOCTYPE="EXTERNALCONTENT"
            xlink:href="@document.actualSourceUrl"/>
      </mets:file>
    </mets:fileGrp>
  </mets:fileSec>
  <mets:structMap TYPE="LOGICAL">
    <mets:div CONTENTIDS="@document.ark"
        DMDID="dmd0001 dmd0002" ID="log0001"
        TYPE="@{
          if(document.isWholeBook) "Monograph"
          else if(document.isJournalIssue) "Issue"
          else "Article"
        }">
      <mets:fptr FILEID="file0001"/>
    </mets:div>
  </mets:structMap>
</mets:mets>

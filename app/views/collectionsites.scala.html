@(collection: DCollection, user: User)


@main("", user){
    
    <h1>Collection @collection.title Targets</h1>
	<div class="targettabs">    
		<ul class="nav nav-tabs">
		   <li><a href="@routes.CollectionEdit.view(collection.url)" class="navbar-brand btn btn-success">View</a></li>
		   <li class="active"><a href="@routes.CollectionEdit.sites(collection.url)" class="navbar-brand btn btn-success">Sites</a></li> 
		   @if(user.hasRole("sys_admin")) {
		   <li><a href="@routes.CollectionEdit.edit(collection.url)" class="navbar-brand btn btn-success">Edit</a></li>
		   }
		</ul>
	</div>
    
    <article class="collectiondetails">
		<table class="table table-striped table-bordered table-hover table-condensed">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Categories</th>
                  <th>Subject</th>
                  <th>By</th>
                  <th>Crawled Instances</th>
                  <th>Crawled URLs</th>
                </tr>
              </thead>
              <tbody>
              	@Target.findAllforCollection(collection.url).map { target =>		              
                <tr>
                  <td><a class="brand" href="@routes.TargetEdit.view(target.url)">@target.title</a><br><a class="brand" href="@target.get_field_list_as_str("field_url")">@target.get_field_list_as_str("field_url")</a></td>
                  @if(target.field_collection_categories != null && Taxonomy.findListByUrl(target.field_collection_categories) != null) { 
	                <td>
	                	@for(taxonomy <- Taxonomy.findListByUrl(target.field_collection_categories)) {
	                	    @if(taxonomy.url != null) {
		            		<a href="@routes.TaxonomyEdit.edit(taxonomy.url)">@taxonomy.name</a>,&nbsp;
		            		}
			            }
    	            </td>
                  } else {
	                  <td></td>
                  }	                  
                  <td>@Taxonomy.findByUrl(target.field_subject).name</td>
                  @if(target.field_nominating_organisation != null) { 
    	              <td><a href="@routes.UserEdit.edit(target.author)">@User.findByUrl(target.author).name</a></td>
                  } else {
	                  <td></td>
                  }	
                  <td></td>
                  <td></td>
                </tr>
                }
              </tbody>
         </table>
	</article>          
}

